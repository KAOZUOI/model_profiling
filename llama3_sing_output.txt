Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 125.49it/s]
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
<|begin_of_text|>The future of AI is in the hands of young people. We need to help them to become the creators, not the victims, of AI.
Artificial intelligence (AI) is one of the most exciting and transformative technologies of our time. It has the potential to revolutionize every aspect of our lives, from healthcare to transportation to education. But with great power comes great responsibility, and we must ensure that AI is used in a way that benefits society as a whole.
One of the most pressing issues facing AI today is the
Generating '/tmp/nsys-report-51d4.qdstrm'
[1/7] [0%                          ] llama3_8b_profile_stats.nsys-rep[1/7] [0%                          ] llama3_8b_profile_stats.nsys-rep[1/7] [5%                          ] llama3_8b_profile_stats.nsys-rep[1/7] [10%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [5%                          ] llama3_8b_profile_stats.nsys-rep[1/7] [=17%                        ] llama3_8b_profile_stats.nsys-rep[1/7] [14%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [12%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [11%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [==20%                       ] llama3_8b_profile_stats.nsys-rep[1/7] [==18%                       ] llama3_8b_profile_stats.nsys-rep[1/7] [=16%                        ] llama3_8b_profile_stats.nsys-rep[1/7] [=15%                        ] llama3_8b_profile_stats.nsys-rep[1/7] [14%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [12%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [11%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [10%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [9%                          ] llama3_8b_profile_stats.nsys-rep[1/7] [8%                          ] llama3_8b_profile_stats.nsys-rep[1/7] [7%                          ] llama3_8b_profile_stats.nsys-rep[1/7] [11%                         ] llama3_8b_profile_stats.nsys-rep[1/7] [=15%                        ] llama3_8b_profile_stats.nsys-rep[1/7] [==18%                       ] llama3_8b_profile_stats.nsys-rep[1/7] [===22%                      ] llama3_8b_profile_stats.nsys-rep[1/7] [====26%                     ] llama3_8b_profile_stats.nsys-rep[1/7] [=====29%                    ] llama3_8b_profile_stats.nsys-rep[1/7] [======33%                   ] llama3_8b_profile_stats.nsys-rep[1/7] [=======37%                  ] llama3_8b_profile_stats.nsys-rep[1/7] [========40%                 ] llama3_8b_profile_stats.nsys-rep[1/7] [=========44%                ] llama3_8b_profile_stats.nsys-rep[1/7] [==========48%               ] llama3_8b_profile_stats.nsys-rep[1/7] [===========51%              ] llama3_8b_profile_stats.nsys-rep[1/7] [============55%             ] llama3_8b_profile_stats.nsys-rep[1/7] [=============58%            ] llama3_8b_profile_stats.nsys-rep[1/7] [==============62%           ] llama3_8b_profile_stats.nsys-rep[1/7] [===============66%          ] llama3_8b_profile_stats.nsys-rep[1/7] [================69%         ] llama3_8b_profile_stats.nsys-rep[1/7] [=================73%        ] llama3_8b_profile_stats.nsys-rep[1/7] [==================77%       ] llama3_8b_profile_stats.nsys-rep[1/7] [==================78%       ] llama3_8b_profile_stats.nsys-rep[1/7] [========================100%] llama3_8b_profile_stats.nsys-rep[1/7] [========================100%] llama3_8b_profile_stats.nsys-rep
[2/7] [0%                          ] llama3_8b_profile_stats.sqlite[2/7] [1%                          ] llama3_8b_profile_stats.sqlite[2/7] [2%                          ] llama3_8b_profile_stats.sqlite[2/7] [3%                          ] llama3_8b_profile_stats.sqlite[2/7] [4%                          ] llama3_8b_profile_stats.sqlite[2/7] [5%                          ] llama3_8b_profile_stats.sqlite[2/7] [6%                          ] llama3_8b_profile_stats.sqlite[2/7] [7%                          ] llama3_8b_profile_stats.sqlite[2/7] [8%                          ] llama3_8b_profile_stats.sqlite[2/7] [9%                          ] llama3_8b_profile_stats.sqlite[2/7] [10%                         ] llama3_8b_profile_stats.sqlite[2/7] [11%                         ] llama3_8b_profile_stats.sqlite[2/7] [12%                         ] llama3_8b_profile_stats.sqlite[2/7] [13%                         ] llama3_8b_profile_stats.sqlite[2/7] [14%                         ] llama3_8b_profile_stats.sqlite[2/7] [=15%                        ] llama3_8b_profile_stats.sqlite[2/7] [=16%                        ] llama3_8b_profile_stats.sqlite[2/7] [=17%                        ] llama3_8b_profile_stats.sqlite[2/7] [==18%                       ] llama3_8b_profile_stats.sqlite[2/7] [==19%                       ] llama3_8b_profile_stats.sqlite[2/7] [==20%                       ] llama3_8b_profile_stats.sqlite[2/7] [==21%                       ] llama3_8b_profile_stats.sqlite[2/7] [===22%                      ] llama3_8b_profile_stats.sqlite[2/7] [===23%                      ] llama3_8b_profile_stats.sqlite[2/7] [===24%                      ] llama3_8b_profile_stats.sqlite[2/7] [====25%                     ] llama3_8b_profile_stats.sqlite[2/7] [====26%                     ] llama3_8b_profile_stats.sqlite[2/7] [====27%                     ] llama3_8b_profile_stats.sqlite[2/7] [====28%                     ] llama3_8b_profile_stats.sqlite[2/7] [=====29%                    ] llama3_8b_profile_stats.sqlite[2/7] [=====30%                    ] llama3_8b_profile_stats.sqlite[2/7] [=====31%                    ] llama3_8b_profile_stats.sqlite[2/7] [=====32%                    ] llama3_8b_profile_stats.sqlite[2/7] [======33%                   ] llama3_8b_profile_stats.sqlite[2/7] [======34%                   ] llama3_8b_profile_stats.sqlite[2/7] [======35%                   ] llama3_8b_profile_stats.sqlite[2/7] [=======36%                  ] llama3_8b_profile_stats.sqlite[2/7] [=======37%                  ] llama3_8b_profile_stats.sqlite[2/7] [=======38%                  ] llama3_8b_profile_stats.sqlite[2/7] [=======39%                  ] llama3_8b_profile_stats.sqlite[2/7] [========40%                 ] llama3_8b_profile_stats.sqlite[2/7] [========41%                 ] llama3_8b_profile_stats.sqlite[2/7] [========42%                 ] llama3_8b_profile_stats.sqlite[2/7] [=========43%                ] llama3_8b_profile_stats.sqlite[2/7] [=========44%                ] llama3_8b_profile_stats.sqlite[2/7] [=========45%                ] llama3_8b_profile_stats.sqlite[2/7] [=========46%                ] llama3_8b_profile_stats.sqlite[2/7] [==========47%               ] llama3_8b_profile_stats.sqlite[2/7] [==========48%               ] llama3_8b_profile_stats.sqlite[2/7] [==========49%               ] llama3_8b_profile_stats.sqlite[2/7] [===========50%              ] llama3_8b_profile_stats.sqlite[2/7] [===========51%              ] llama3_8b_profile_stats.sqlite[2/7] [===========52%              ] llama3_8b_profile_stats.sqlite[2/7] [===========53%              ] llama3_8b_profile_stats.sqlite[2/7] [============54%             ] llama3_8b_profile_stats.sqlite[2/7] [============55%             ] llama3_8b_profile_stats.sqlite[2/7] [============56%             ] llama3_8b_profile_stats.sqlite[2/7] [============57%             ] llama3_8b_profile_stats.sqlite[2/7] [=============58%            ] llama3_8b_profile_stats.sqlite[2/7] [=============59%            ] llama3_8b_profile_stats.sqlite[2/7] [=============60%            ] llama3_8b_profile_stats.sqlite[2/7] [==============61%           ] llama3_8b_profile_stats.sqlite[2/7] [==============62%           ] llama3_8b_profile_stats.sqlite[2/7] [==============63%           ] llama3_8b_profile_stats.sqlite[2/7] [==============64%           ] llama3_8b_profile_stats.sqlite[2/7] [===============65%          ] llama3_8b_profile_stats.sqlite[2/7] [===============66%          ] llama3_8b_profile_stats.sqlite[2/7] [===============67%          ] llama3_8b_profile_stats.sqlite[2/7] [================68%         ] llama3_8b_profile_stats.sqlite[2/7] [================69%         ] llama3_8b_profile_stats.sqlite[2/7] [================70%         ] llama3_8b_profile_stats.sqlite[2/7] [================71%         ] llama3_8b_profile_stats.sqlite[2/7] [=================72%        ] llama3_8b_profile_stats.sqlite[2/7] [=================73%        ] llama3_8b_profile_stats.sqlite[2/7] [=================74%        ] llama3_8b_profile_stats.sqlite[2/7] [==================75%       ] llama3_8b_profile_stats.sqlite[2/7] [==================76%       ] llama3_8b_profile_stats.sqlite[2/7] [==================77%       ] llama3_8b_profile_stats.sqlite[2/7] [==================78%       ] llama3_8b_profile_stats.sqlite[2/7] [===================79%      ] llama3_8b_profile_stats.sqlite[2/7] [===================80%      ] llama3_8b_profile_stats.sqlite[2/7] [===================81%      ] llama3_8b_profile_stats.sqlite[2/7] [===================82%      ] llama3_8b_profile_stats.sqlite[2/7] [====================83%     ] llama3_8b_profile_stats.sqlite[2/7] [====================84%     ] llama3_8b_profile_stats.sqlite[2/7] [====================85%     ] llama3_8b_profile_stats.sqlite[2/7] [=====================86%    ] llama3_8b_profile_stats.sqlite[2/7] [=====================87%    ] llama3_8b_profile_stats.sqlite[2/7] [=====================88%    ] llama3_8b_profile_stats.sqlite[2/7] [=====================89%    ] llama3_8b_profile_stats.sqlite[2/7] [======================90%   ] llama3_8b_profile_stats.sqlite[2/7] [======================91%   ] llama3_8b_profile_stats.sqlite[2/7] [======================92%   ] llama3_8b_profile_stats.sqlite[2/7] [=======================93%  ] llama3_8b_profile_stats.sqlite[2/7] [=======================94%  ] llama3_8b_profile_stats.sqlite[2/7] [=======================95%  ] llama3_8b_profile_stats.sqlite[2/7] [=======================96%  ] llama3_8b_profile_stats.sqlite[2/7] [========================97% ] llama3_8b_profile_stats.sqlite[2/7] [========================98% ] llama3_8b_profile_stats.sqlite[2/7] [========================99% ] llama3_8b_profile_stats.sqlite[2/7] [========================100%] llama3_8b_profile_stats.sqlite[2/7] [========================100%] llama3_8b_profile_stats.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)   Style                    Range                 
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  -------  ---------------------------------------
     96.6       2880947121          1  2880947121.0  2880947121.0  2880947121  2880947121          0.0  PushPop  :Full_Inference                        
      1.6         47029870          1    47029870.0    47029870.0    47029870    47029870          0.0  PushPop  cuBLAS:cublasCreate_v2                 
      1.1         31319138        100      313191.4       54098.0       51430    25808086    2575245.2  PushPop  CCCL:cub::DeviceRadixSort              
      0.6         17946923        201       89288.2       16357.0       13422    14492510    1021020.5  PushPop  CCCL:cub::DeviceScan::InclusiveScan    
      0.1          3588742        200       17943.7       17140.0       10984       94559       7916.5  PushPop  CCCL:cub::DeviceScan::InclusiveSumByKey

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)   StdDev (ns)                        Name                      
 --------  ---------------  ---------  ---------  ---------  --------  ---------  -----------  ------------------------------------------------
     86.1       6804179065       1508  4512055.1     5362.5      2813  469641572   20473119.8  cudaMemcpyAsync                                 
     10.9        857466475     137222     6248.8     3350.0      2574   57207258     241505.6  cudaLaunchKernel                                
      1.2         90959424        209   435212.6   169250.0      3696   14098298    1253554.9  cudaMalloc                                      
      1.0         79786393      22500     3546.1     3379.0      2834     210469       2231.0  cuLaunchKernelEx                                
      0.6         46222807         18  2567933.7  2807290.5     23788    6457778    2281485.5  cuLibraryLoadData                               
      0.1          8415124        600    14025.2     9120.5      3201      30768       8092.3  cudaStreamSynchronize                           
      0.0          3725074        900     4139.0     3327.0      2262      19870       1727.1  cudaMemsetAsync                                 
      0.0          3367348      45000       74.8       68.0        50       5316         33.2  cuKernelGetAttribute                            
      0.0          2277688       3606      631.6      595.0       229      21563        425.4  cudaStreamIsCapturing_v10000                    
      0.0          2010792          1  2010792.0  2010792.0   2010792    2010792          0.0  cudaFree                                        
      0.0          1181485        100    11814.9     1172.5      1012     993185      99346.2  cuKernelGetFunction                             
      0.0          1029522          2   514761.0   514761.0     18236    1011286     702192.4  cudaHostAlloc                                   
      0.0           473270        100     4732.7     4520.0      4196      18575       1446.9  cuLaunchKernel                                  
      0.0           186449        810      230.2      137.0        67       6601        379.2  cuGetProcAddress_v2                             
      0.0            15843         18      880.2      250.5       227       7056       1713.1  cudaEventCreateWithFlags                        
      0.0            10648         20      532.4      469.0       241       1137        224.1  cuLibraryGetKernel                              
      0.0             7401         18      411.2      316.5       295       2027        403.8  cudaOccupancyMaxActiveClusters_v11070           
      0.0             7005          8      875.6      663.0       330       2284        654.2  cuKernelSetAttribute                            
      0.0             4060          1     4060.0     4060.0      4060       4060          0.0  cudaOccupancyAvailableDynamicSMemPerBlock_v10200
      0.0             3683          3     1227.7     1117.0      1044       1522        257.5  cuInit                                          
      0.0             1820          3      606.7      176.0       150       1494        768.6  cuModuleGetLoadingMode                          
      0.0             1404          2      702.0      702.0       427        977        388.9  cudaGetDriverEntryPoint_v11030                  

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     28.4        263687871       6400   41201.2   41184.0     39393     43489        740.0  nvjet_tst_64x8_64x16_2x1_v_bz_TNT                                                                   
     23.6        219411060       9600   22855.3   14049.0     13247     42592      12577.2  nvjet_tst_64x8_64x16_2x1_v_bz_splitK_TNT                                                            
      4.2         39091666       6400    6108.1    6080.0      5792      7745        173.0  nvjet_tst_64x8_64x16_4x1_v_bz_splitK_TNT                                                            
      4.1         37660882      12865    2927.4    3008.0      2240      3712        271.3  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      3.8         35366915      16000    2210.4    2208.0      1951      3200        175.0  void cublasLt::splitKreduce_kernel<(int)32, (int)16, int, float, __nv_bfloat16, float, (bool)0, flo…
      3.8         35221567        100  352215.7  350129.0    344897    371169       6363.8  nvjet_tst_384x8_64x4_2x1_v_bz_TNT                                                                   
      2.4         22367573       6464    3460.3    3456.0      3263      4192        113.5  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)2>,…
      2.4         22287521       6500    3428.8    3455.5      2912      5152        294.8  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::MeanOps<fl…
      2.4         22146109       3168    6990.6    6080.0      5760      8864       1174.6  void pytorch_flash::flash_fwd_kernel<pytorch_flash::Flash_fwd_kernel_traits<(int)128, (int)128, (in…
      2.3         20982765       6464    3246.1    3264.0      2400      3552        146.9  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      2.2         20844694      12736    1636.7    1632.0      1215      2720        222.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<c10::BFloat16>, …
      2.2         20487709       6700    3057.9    3104.0      1440      4384        281.9  void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterator…
      2.2         20408345       6700    3046.0    3008.0      1312      3713        319.8  void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterator…
      2.1         19426215       6272    3097.3    3104.0      2687      3712        188.4  void at::native::<unnamed>::CatArrayBatchedCopy_contig<at::native::<unnamed>::OpaqueType<(unsigned …
      1.9         17916065       9635    1859.5    1760.0      1567      3168        198.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<c10::BFloat16, c10…
      1.9         17260412       6400    2696.9    2720.0      2208      3296        274.7  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      1.7         15667998       6500    2410.5    2432.0      2207      3136         89.7  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      1.2         10991154        200   54955.8   54976.0     53601     56127        336.9  void at::native::<unnamed>::cunn_SoftMaxForward<(int)4, float, float, float, at::native::<unnamed>:…
      1.2         10881090       6500    1674.0    1664.0      1279      2528        173.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::rsqrt_kernel_cuda(at::TensorIter…
      1.1         10539016       6500    1621.4    1600.0      1248      2528        204.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, at…
      1.1         10230632       6500    1573.9    1569.0      1408      2272         69.6  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::<unnamed>::pow_tensor_scala…
      0.8          7125566       3200    2226.7    2208.0      1920      2944        115.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::<unnamed>::silu_kernel(at::Tenso…
      0.4          3881280        400    9703.2    9664.0      8960     10752        303.5  void at::native::mbtopk::radixFindKthValues<float, unsigned int, unsigned int, (int)1>(at::cuda::de…
      0.4          3420386        400    8551.0    8672.0      7648      9696        496.8  void at_cuda_detail::cub::DeviceRadixSortOnesweepKernel<at_cuda_detail::cub::DeviceRadixSortPolicy<…
      0.3          2828357        100   28283.6   28272.0     26944     29984        466.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::ArgMaxOps<…
      0.1          1362818        100   13628.2   13647.5     13344     14112        144.2  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      0.1          1303807        100   13038.1   13040.0     12832     13280         72.4  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      0.1          1299016        100   12990.2   12992.0     12768     13184         75.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      0.1           988161        400    2470.4    2464.0      2272      2912         96.6  void at::native::mbtopk::computeBlockwiseWithinKCounts<unsigned int>(T1 *, short *, unsigned int, i…
      0.1           631455        200    3157.3    3136.0      2912      3520        142.6  void at_cuda_detail::cub::DeviceScanByKeyKernel<at_cuda_detail::cub::DeviceScanByKeyPolicy<at_cuda_…
      0.1           601378        100    6013.8    6015.5      5856      6336         99.9  void at::native::radixSortKVInPlace<(int)-2, (int)-1, (int)32, (int)4, float, long, unsigned int>(a…
      0.1           527620        200    2638.1    2640.0      2463      2880        145.5  void at::native::_assert_async_cuda_kernel<bool>(const T1 *, at::native::Msg)                       
      0.1           501181        100    5011.8    5120.0      4384      5344        249.2  void at::native::mbtopk::gatherTopK<float, unsigned int, (int)1>(at::cuda::detail::TensorInfo<const…
      0.1           484168        300    1613.9    1600.0      1248      2080        217.5  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<float…
      0.1           469992        200    2350.0    2336.0      2016      2912        194.5  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.0           435075        300    1450.3    1504.0      1312      1537         80.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, bool, …
      0.0           393367        100    3933.7    3936.0      3744      4063         53.4  void at::native::_scatter_gather_elementwise_kernel<(int)128, (int)4, void at::native::_cuda_scatte…
      0.0           380608        100    3806.1    3808.0      3744      3872         28.6  void at_cuda_detail::cub::DeviceRadixSortHistogramKernel<at_cuda_detail::cub::DeviceRadixSortPolicy…
      0.0           362881        100    3628.8    3616.0      3424      4096        118.5  void at_cuda_detail::cub::DeviceScanKernel<at_cuda_detail::cub::DeviceScanPolicy<float, std::plus<f…
      0.0           360583        303    1190.0    1152.0      1119      1503         84.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<bool>, at::detail::A…
      0.0           360345        200    1801.7    1792.0      1728      1953         45.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::<unnamed>::masked_fill_kernel(at…
      0.0           345856         99    3493.5    3488.0      3392      3616         39.3  void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8x5_tn_align1>(T1::Params)                       
      0.0           337661        100    3376.6    3424.0      3072      3521        112.9  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0           322112        200    1610.6    1600.0      1280      2112        116.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<long>, at:…
      0.0           311265        200    1556.3    1568.0      1312      1824         81.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<long, long, long, …
      0.0           304673        100    3046.7    3040.0      3007      3168         23.3  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<float, (int)4, void at::nat…
      0.0           300353        100    3003.5    2976.5      2880      3200         70.4  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<long, at::native::func_wrappe…
      0.0           295295        100    2953.0    2944.0      2623      3296        159.4  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<bool, at::native::func_wrappe…
      0.0           292166        200    1460.8    1519.5      1311      1601        124.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<bool, bool, bool, …
      0.0           291523        202    1443.2    1440.0      1311      1793        115.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::bitwise_not_kernel_cuda(at::Tens…
      0.0           289281         32    9040.0    9088.0      7840      9312        253.9  void pytorch_flash::flash_fwd_kernel<pytorch_flash::Flash_fwd_kernel_traits<(int)128, (int)128, (in…
      0.0           284544        100    2845.4    2784.0      2688      6432        373.0  void at::native::<unnamed>::indexSelectSmallIndex<c10::BFloat16, long, unsigned int, (int)2, (int)2…
      0.0           278079         99    2808.9    2784.0      2720      3136         76.6  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.0           277485        200    1387.4    1391.5      1215      1569        146.6  void at_cuda_detail::cub::DeviceScanByKeyInitKernel<at_cuda_detail::cub::ReduceByKeyScanTileState<u…
      0.0           272604        200    1363.0    1408.0      1247      1504         94.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      0.0           268641         99    2713.5    2688.0      2656      2912         47.7  void at::native::<unnamed>::CatArrayBatchedCopy_aligned16_contig<at::native::<unnamed>::OpaqueType<…
      0.0           233000        100    2330.0    2336.0      2272      2400         23.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      0.0           209696        100    2097.0    2080.0      2048      2368         44.2  at::native::<unnamed>::fill_reverse_indices_kernel(long *, int, at::cuda::detail::IntDivider<unsign…
      0.0           203143        101    2011.3    2016.0      1760      2241        105.8  void at_cuda_detail::cub::DeviceScanKernel<at_cuda_detail::cub::DeviceScanPolicy<long, std::plus<lo…
      0.0           199746         64    3121.0    3136.0      2848      3360        165.6  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0           182788        100    1827.9    1824.0      1760      1920         35.9  void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<long, long, long, at::native…
      0.0           178564        100    1785.6    1792.0      1728      1888         28.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sin_kernel_cuda(at::TensorIterat…
      0.0           174302        103    1692.3    1664.0      1120      2337        119.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<long>, at::detail::A…
      0.0           172672        100    1726.7    1727.0      1663      1952         60.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BUnaryFunctor<float, float, floa…
      0.0           170945        100    1709.5    1696.0      1664      1760         18.3  void at_cuda_detail::cub::DeviceRadixSortExclusiveSumKernel<at_cuda_detail::cub::DeviceRadixSortPol…
      0.0           164575        100    1645.8    1632.0      1599      1952         56.9  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<long>…
      0.0           164441        101    1628.1    1663.0      1503      1920        111.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<long>, at::detai…
      0.0           164424        100    1644.2    1632.0      1600      1856         31.8  void at::native::mbtopk::computeBlockwiseKthCounts<unsigned int>(T1 *, short *, unsigned int, unsig…
      0.0           164413        100    1644.1    1632.0      1599      1760         32.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::cos_kernel_cuda(at::TensorIterat…
      0.0           159651        100    1596.5    1568.0      1535      2048         62.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<bool, bool, bool, …
      0.0           142913        100    1429.1    1408.0      1376      1600         43.9  void at::native::mbtopk::fill<unsigned int, unsigned int>(T1 *, T1, T2)                             
      0.0           138786        100    1387.9    1344.5      1311      1568         73.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::<unnamed>::masked_fill_kernel(at…
      0.0           131354        100    1313.5    1312.0      1279      1408         29.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, bool…
      0.0           129282        101    1280.0    1280.0      1247      1568         32.0  void at_cuda_detail::cub::DeviceScanInitKernel<at_cuda_detail::cub::ScanTileState<long, (bool)1>>(T…
      0.0           129120        100    1291.2    1280.0      1248      1344         17.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnOther_add<long>, at…
      0.0           127229        100    1272.3    1280.0      1247      1376         29.5  void at_cuda_detail::cub::DeviceScanInitKernel<at_cuda_detail::cub::ScanTileState<float, (bool)1>>(…
      0.0           112001        100    1120.0    1120.0      1088      1152         10.1  void at::native::unrolled_elementwise_kernel<at::native::FillFunctor<bool>, at::detail::Array<char …
      0.0            66692         50    1333.8    1280.0      1248      1505         92.7  void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<long, long, bool, at::native…
      0.0            38593         27    1429.4    1408.0      1311      1632        113.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<long, long, bool, …
      0.0            35392         25    1415.7    1344.0      1312      1568        104.2  void at::native::vectorized_elementwise_kernel<(int)2, at::native::BinaryFunctor<long, long, bool, …
      0.0             5024          2    2512.0    2512.0      2400      2624        158.4  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl<at::native::…
      0.0             3840          2    1920.0    1920.0      1824      2016        135.8  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0             3552          1    3552.0    3552.0      3552      3552          0.0  void at::native::reduce_kernel<(int)256, (int)2, at::native::ReduceOp<bool, at::native::func_wrappe…
      0.0             3392          1    3392.0    3392.0      3392      3392          0.0  void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8x5_nn_align1>(T1::Params)                       
      0.0             3232          1    3232.0    3232.0      3232      3232          0.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<bool, at::native::func_wrappe…
      0.0             3104          1    3104.0    3104.0      3104      3104          0.0  void at::native::<unnamed>::CatArrayBatchedCopy<at::native::<unnamed>::OpaqueType<(unsigned int)4>,…
      0.0             1760          1    1760.0    1760.0      1760      1760          0.0  void at::native::unrolled_elementwise_kernel<at::native::CUDAFunctorOnSelf_add<long>, at::detail::A…
      0.0             1695          1    1695.0    1695.0      1695      1695          0.0  void at::native::unrolled_elementwise_kernel<void at::native::compare_scalar_kernel<long>(at::Tenso…
      0.0             1536          1    1536.0    1536.0      1536      1536          0.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<bool, bool, bool, …
      0.0             1441          1    1441.0    1441.0      1441      1441          0.0  void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterator…

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)    Med (ns)   Min (ns)  Max (ns)   StdDev (ns)            Operation           
 --------  ---------------  -----  ----------  ----------  --------  ---------  -----------  ------------------------------
    100.0       6698039118    296  22628510.5  13293717.0       736  469165098   41370555.0  [CUDA memcpy Host-to-Device]  
      0.0          1357924    908      1495.5      1440.0      1184       2016        160.6  [CUDA memcpy Device-to-Device]
      0.0          1064315    900      1182.6      1280.0       703       1792        291.2  [CUDA memset]                 
      0.0           684321    304      2251.1      2240.0      2144       3200        102.9  [CUDA memcpy Device-to-Host]  

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
  16060.523    296    54.259    33.554     0.000  1050.673       96.323  [CUDA memcpy Host-to-Device]  
    166.735    908     0.184     0.000     0.000     0.513        0.235  [CUDA memcpy Device-to-Device]
     10.702    900     0.012     0.008     0.000     0.025        0.012  [CUDA memset]                 
      0.001    304     0.000     0.000     0.000     0.001        0.000  [CUDA memcpy Device-to-Host]  

Generated:
    /root/kernel_dev/profiling/nsys_out/llama3_8b_profile_stats.nsys-rep
    /root/kernel_dev/profiling/nsys_out/llama3_8b_profile_stats.sqlite
